# Skill: process-emails

**Name**: process-emails

**Description**: Processes incoming emails from Gmail watcher and creates appropriate responses with human approval

**Version**: 1.0

**Trigger Phrases**:
- "process my emails"
- "handle incoming emails"
- "check email responses"
- "process email queue"

## Purpose
This skill processes incoming emails that were detected by the Gmail watcher and placed in the /Needs_Action folder. It categorizes emails, calculates priority scores, drafts appropriate responses using templates, and creates approval requests for human review before sending.

## Behavior
1. Scans the /Needs_Action folder for EMAIL_*.md files created by the Gmail watcher
2. For each email file:
   - Parses the frontmatter to get email metadata (sender, subject, received time, priority)
   - Extracts the email content and body
   - Categorizes the email type (client, sales, admin, team, spam)
   - Calculates a priority score (0-100) based on keywords and sender
   - Selects an appropriate response template based on category
   - Drafts a professional response
3. Creates an approval request in /Pending_Approval/ with the draft response
4. Updates the Dashboard.md with email statistics
5. Logs the activity in /Logs/[today's-date].txt

## Email Categories
- **Client**: Emails from known clients or customers
- **Sales**: Potential sales leads or inquiries
- **Admin**: Administrative tasks or internal communications
- **Team**: Internal team communication
- **Spam**: Unwanted or irrelevant emails

## Priority Calculation
- Base priority: 50
- +20 for urgent, asap, emergency keywords
- +20 for invoice, payment, bill keywords
- +15 for known client names or VIP senders
- +10 for weekend/holiday emails requiring immediate attention
- Maximum priority: 100

## Email Templates

### Client Response Template
```markdown
Dear [Client Name],

Thank you for reaching out regarding [subject]. We appreciate your inquiry and will address your concerns promptly.

[Customized response based on email content]

We value your business and look forward to continuing our partnership.

Best regards,
AI Employee Assistant
```

### Sales Lead Response Template
```markdown
Dear [Sender Name],

Thank you for your interest in our services/products. We appreciate your inquiry about [subject].

[Customized response highlighting relevant offerings]

We would be happy to discuss how we can help you achieve your goals.

Best regards,
AI Employee Assistant
```

### Admin Acknowledgment Template
```markdown
Hello,

Thank you for the information regarding [subject]. This has been noted and will be processed accordingly.

[Specific action items or acknowledgments]

Have a great day.

Best regards,
AI Employee Assistant
```

### Team Communication Template
```markdown
Hi Team,

Thank you for the update on [subject]. This information has been received and documented.

[Relevant action items or next steps]

Best regards,
AI Employee Assistant
```

### Spam/Auto-Reject Template
```markdown
This email has been identified as potentially unwanted or irrelevant and will be handled accordingly.

No response will be sent.
```

## Approval Request Format
```markdown
---
action_type: email_send
action_id: email_response_[timestamp]
priority: [calculated priority]
risk_level: [low/medium/high based on content]
created: [ISO timestamp]
expires: [ISO timestamp + 24 hours]
status: pending_approval
email_thread_id: [original email thread ID]
---

# üîê Approval Required: Email Response

## Action Summary
Send response to email from [sender] regarding "[subject]"

## Details

**Type:** Email Response
**Requested by:** AI Employee
**Reason:** Process incoming email
**Impact:** Send professional response
**Risk:** [risk level]

## Draft Response
```
[Drafted response content]
```

## Approval Instructions
‚úÖ To Approve: Move this file to /Approved folder
‚ùå To Reject: Move this file to /Rejected folder
‚úèÔ∏è To Modify: Edit the response above, then move to /Approved

## Expiration
This approval request will expire on: [expiration date/time]
After expiration, the response will be cancelled.

---
*Approval request generated by AI Employee*
```

## Error Handling
- If no EMAIL_*.md files found, respond with "No emails to process"
- If email file is corrupted, skip and log the error
- If unable to categorize, default to "admin" category
- If template selection fails, use generic response template
- Always create approval request even if response drafting fails

## Constraints
- Never send emails without human approval
- Always respect the priority scoring system
- Use professional and appropriate tone in all responses
- Include proper salutations and sign-offs
- Maintain company branding in responses
- Never reveal that AI composed the response

## Implementation Notes
The skill should use file system tools to read email files, parse YAML frontmatter, categorize content based on keywords, select appropriate templates, draft responses using Company_Handbook.md guidelines, and create approval requests following the established pattern.